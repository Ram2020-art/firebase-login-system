<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase Login System</title>
</head>
<body>
  <h1>Login and Registration</h1>

  <div id="auth-section">
    <h2>Login</h2>
    <form id="login-form">
      <input type="email" id="login-email" placeholder="Email" required />
      <input type="password" id="login-password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>

    <h2>Register</h2>
    <form id="register-form">
      <input type="email" id="register-email" placeholder="Email" required />
      <input type="password" id="register-password" placeholder="Password" required />
      <button type="submit">Register</button>
    </form>
  </div>

  <!-- Firebase SDKs -->
  <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCRKx9cwmDfIplGlZMGOLEJ2FHpr6LLL3E",
            authDomain: "remark-d4293.firebaseapp.com",
            projectId: "remark-d4293",
            storageBucket: "remark-d4293.firebasestorage.app",
            messagingSenderId: "307655533150",
            appId: "1:307655533150:web:12bf2f02c5b75384748acf",
            measurementId: "G-JM3DLTB3BT"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.getAuth(app);
        const db = firebase.getFirestore(app);

        console.log("Firebase Initialized:", app);

        // Switch between Login and Register forms
        function toggleForm() {
            const loginForm = document.querySelector('.login-form');
            const registerForm = document.querySelector('.register-form');
            loginForm.style.display = loginForm.style.display === 'none' ? 'block' : 'none';
            registerForm.style.display = registerForm.style.display === 'none' ? 'block' : 'none';
        }

        // Register user
        function registerUser() {
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            console.log("Registering user with email:", email);

            firebase.createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    console.log("User registered:", userCredential.user);
                    alert('Registration successful!');
                    window.location.reload();
                })
                .catch((error) => {
                    console.error("Registration error:", error);
                    alert('Error: ' + error.message);
                });
        }

        // Login user
        function loginUser() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            console.log("Logging in user with email:", email);

            firebase.signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    console.log("Login successful:", user);
                    alert('Login successful!');
                    // Redirect to the desired page
                    window.location.href = 'https://ram2020-art.github.io/NokiaRouter/';
                    
                    // Save user data to Firestore
                    saveUserData(user);
                })
                .catch((error) => {
                    console.error("Login error:", error);
                    alert('Error: ' + error.message);
                });
        }

        // Save user data to Firestore
        function saveUserData(user) {
            const userRef = firebase.doc(db, 'users', user.uid);
            firebase.setDoc(userRef, {
                email: user.email,
                uid: user.uid,
                lastLogin: new Date()
            })
            .then(() => {
                console.log('User data saved successfully!');
            })
            .catch((error) => {
                console.error('Error saving user data: ', error);
            });
        }
    </script>
</body>
</html>
